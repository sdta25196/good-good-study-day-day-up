<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.5;
  filter:Alpha(opacity=50);
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <p class="x">æ‰€æœ‰æœ€æ–°æå®¢æ—¶é—´è¯¾ç¨‹è¯·åŠ QQç¾¤170701297</p>
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                ç¬¬12è®²è®²TCPåè®®ï¼ˆä¸‹ï¼‰ï¼šè¥¿è¡Œå¿…å®šå¤šå¦–å­½ï¼Œæ’å¿ƒæ™ºæ…§æ¶ˆç£¨éš¾
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/2d/62/2dc5971d53278502b34a0253d69ee062.jpg">


                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>æˆ‘ä»¬å‰é¢è¯´åˆ°ç„å¥˜è¥¿è¡Œï¼Œè¦å‡ºç½‘å…³ã€‚æ—¢ç„¶å‡ºäº†ç½‘å…³ï¼Œé‚£å°±æ˜¯åœ¨å…¬ç½‘ä¸Šä¼ è¾“æ•°æ®ï¼Œå…¬ç½‘å¾€å¾€æ˜¯ä¸å¯é çš„ï¼Œå› è€Œéœ€è¦å¾ˆå¤šçš„æœºåˆ¶å»ä¿è¯ä¼ è¾“çš„å¯é æ€§ï¼Œè¿™é‡Œé¢éœ€è¦æ’å¿ƒï¼Œä¹Ÿå³å„ç§<strong>é‡ä¼ çš„ç­–ç•¥</strong>ï¼Œè¿˜éœ€è¦æœ‰æ™ºæ…§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é‡Œé¢åŒ…å«ç€<strong>å¤§é‡çš„ç®—æ³•</strong>ã€‚</p>
<h2 id="-">å¦‚ä½•åšä¸ªé è°±çš„äººï¼Ÿ</h2>
<p>TCPæƒ³æˆä¸ºä¸€ä¸ªæˆç†Ÿç¨³é‡çš„äººï¼Œæˆä¸ºä¸€ä¸ªé è°±çš„äººã€‚é‚£ä¸€ä¸ªäººæ€ä¹ˆæ ·æ‰ç®—é è°±å‘¢ï¼Ÿå’±ä»¬å·¥ä½œä¸­ç»å¸¸å°±æœ‰è¿™æ ·çš„åœºæ™¯ï¼Œæ¯”å¦‚ä½ äº¤ä»£ç»™ä¸‹å±ä¸€ä¸ªäº‹æƒ…ä»¥åï¼Œä¸‹å±åˆ°åº•èƒ½ä¸èƒ½åšåˆ°ï¼Œåšåˆ°ä»€ä¹ˆç¨‹åº¦ï¼Œä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿäº¤ä»˜ï¼Œå¾€å¾€å°±ä¼šæœ‰åº”ç­”ï¼Œæœ‰å›å¤ã€‚è¿™æ ·ï¼Œå¤„ç†äº‹æƒ…çš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦æœ‰å¼‚å¸¸ï¼Œä½ ä¹Ÿå¯ä»¥å°½å¿«çŸ¥é“ï¼Œè€Œä¸æ˜¯äº¤ä»£å®Œä¹‹åå°±çŸ³æ²‰å¤§æµ·ï¼Œè¿‡äº†ä¸€ä¸ªæœˆå†é—®ï¼Œä»–è¯´ï¼Œå•Šæˆ‘ä¸è®°å¾—äº†ã€‚</p>
<p>å¯¹åº”åˆ°ç½‘ç»œåè®®ä¸Šï¼Œå°±æ˜¯å®¢æˆ·ç«¯æ¯å‘é€çš„ä¸€ä¸ªåŒ…ï¼ŒæœåŠ¡å™¨ç«¯éƒ½åº”è¯¥æœ‰ä¸ªå›å¤ï¼Œå¦‚æœæœåŠ¡å™¨ç«¯è¶…è¿‡ä¸€å®šçš„æ—¶é—´æ²¡æœ‰å›å¤ï¼Œå®¢æˆ·ç«¯å°±ä¼šé‡æ–°å‘é€è¿™ä¸ªåŒ…ï¼Œç›´åˆ°æœ‰å›å¤ã€‚</p>
<p>è¿™ä¸ªå‘é€åº”ç­”çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·å‘¢ï¼Ÿå¯ä»¥æ˜¯<strong>ä¸Šä¸€ä¸ªæ”¶åˆ°äº†åº”ç­”ï¼Œå†å‘é€ä¸‹ä¸€ä¸ª</strong>ã€‚è¿™ç§æ¨¡å¼æœ‰ç‚¹åƒä¸¤ä¸ªäººç›´æ¥æ‰“ç”µè¯ï¼Œä½ ä¸€å¥ï¼Œæˆ‘ä¸€å¥ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯æ•ˆç‡æ¯”è¾ƒä½ã€‚å¦‚æœä¸€æ–¹åœ¨ç”µè¯é‚£å¤´å¤„ç†çš„æ—¶é—´æ¯”è¾ƒé•¿ï¼Œè¿™ä¸€å¤´å°±è¦å¹²ç­‰ç€ï¼ŒåŒæ–¹éƒ½æ²¡åŠæ³•å¹²å…¶ä»–äº‹æƒ…ã€‚å’±ä»¬åœ¨æ—¥å¸¸å·¥ä½œä¸­ä¹Ÿä¸æ˜¯è¿™æ ·çš„ï¼Œä¸èƒ½ä½ äº¤ä»£ä½ çš„ä¸‹å±åŠä¸€ä»¶äº‹æƒ…ï¼Œå°±ä¸€ç›´æ‰“ç€ç”µè¯çœ‹ç€ä»–åšï¼Œè€Œæ˜¯åº”è¯¥ä»–æŒ‰ç…§ä½ çš„å®‰æ’ï¼Œå…ˆå°†äº‹æƒ…è®°å½•ä¸‹æ¥ï¼ŒåŠå®Œä¸€ä»¶å›å¤ä¸€ä»¶ã€‚åœ¨ä»–åŠäº‹æƒ…çš„è¿‡ç¨‹ä¸­ï¼Œä½ è¿˜å¯ä»¥åŒæ—¶äº¤ä»£æ–°çš„äº‹æƒ…ï¼Œè¿™æ ·åŒæ–¹å°±å¹¶è¡Œäº†ã€‚</p>
<p>å¦‚æœä½¿â½¤è¿™ç§æ¨¡å¼ï¼Œå…¶å®éœ€è¦ä½ å’Œä½ çš„ä¸‹å±å°±ä¸èƒ½é è„‘â¼¦äº†ï¼Œâ½½æ˜¯è¦éƒ½å‡†å¤‡â¼€ä¸ªæœ¬â¼¦ï¼Œä½ æ¯äº¤ä»£ä¸‹å±â¼€ä¸ªäº‹æƒ…ï¼ŒåŒæ–¹çš„æœ¬å­éƒ½è¦è®°å½•â¼€ä¸‹ã€‚</p>
<p>å½“ä½ çš„ä¸‹å±åšå®Œâ¼€ä»¶äº‹æƒ…ï¼Œå°±å›å¤ä½ ï¼Œåšå®Œäº†ï¼Œä½ å°±åœ¨ä½ çš„æœ¬â¼¦ä¸Šå°†è¿™ä¸ªäº‹æƒ…åˆ’å»ã€‚åŒæ—¶ä½ çš„æœ¬â¼¦ä¸Šæ¯ä»¶äº‹æƒ…éƒ½æœ‰æ—¶é™ï¼Œå¦‚æœè¶…è¿‡äº†æ—¶é™ä¸‹å±è¿˜æ²¡æœ‰å›å¤ï¼Œä½ å°±è¦ä¸»åŠ¨é‡æ–°äº¤ä»£â¼€ä¸‹ï¼šä¸Šæ¬¡é‚£ä»¶äº‹æƒ…ï¼Œä½ è¿˜æ²¡å›å¤æˆ‘ï¼Œå’‹æ ·å•¦ï¼Ÿ</p>
<p>æ—¢ç„¶å¤šä»¶äº‹æƒ…å¯ä»¥ä¸€èµ·å¤„ç†ï¼Œé‚£å°±éœ€è¦ç»™æ¯ä¸ªäº‹æƒ…ç¼–ä¸ªå·ï¼Œé˜²æ­¢å¼„é”™äº†ã€‚ä¾‹å¦‚ï¼Œç¨‹åºå‘˜å¹³æ—¶çœ‹ä»»åŠ¡çš„æ—¶å€™ï¼Œéƒ½ä¼šçœ‹JIRAçš„IDï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½è¦æè¿°ä¸€ä¸‹å…·ä½“çš„äº‹æƒ…ã€‚åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå¯¹äºäº‹æƒ…çš„å¤„ç†æ˜¯æŒ‰ç…§é¡ºåºæ¥çš„ï¼Œå…ˆæ¥çš„å…ˆå¤„ç†ï¼Œè¿™å°±ç»™åº”ç­”å’Œæ±‡æŠ¥å·¥ä½œå¸¦æ¥äº†æ–¹ä¾¿ã€‚ç­‰å¼€å‘¨ä¼šçš„æ—¶å€™ï¼Œæ¯ä¸ªç¨‹åºå‘˜éƒ½å¯ä»¥å°†JIRA IDçš„åˆ—è¡¨æ‹‰å‡ºæ¥ï¼Œè¯´ä»¥ä¸Šçš„éƒ½åšå®Œäº†ï¼Œâ½½ä¸â½¤â¼€ä¸ªä¸ªè¯´ã€‚</p>
<h2 id="-">å¦‚ä½•å®ç°ä¸€ä¸ªé è°±çš„åè®®ï¼Ÿ</h2>
<p>TCPåè®®ä½¿ç”¨çš„ä¹Ÿæ˜¯åŒæ ·çš„æ¨¡å¼ã€‚ä¸ºäº†ä¿è¯é¡ºåºæ€§ï¼Œæ¯ä¸€ä¸ªåŒ…éƒ½æœ‰ä¸€ä¸ªIDã€‚åœ¨å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œä¼šå•†å®šèµ·å§‹çš„IDæ˜¯ä»€ä¹ˆï¼Œç„¶åæŒ‰ç…§IDä¸€ä¸ªä¸ªå‘é€ã€‚ä¸ºäº†ä¿è¯ä¸ä¸¢åŒ…ï¼Œå¯¹äºå‘é€çš„åŒ…éƒ½è¦è¿›è¡Œåº”ç­”ï¼Œä½†æ˜¯è¿™ä¸ªåº”ç­”ä¹Ÿä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªæ¥çš„ï¼Œè€Œæ˜¯ä¼šåº”ç­”æŸä¸ªä¹‹å‰çš„IDï¼Œè¡¨ç¤ºéƒ½æ”¶åˆ°äº†ï¼Œè¿™ç§æ¨¡å¼ç§°ä¸º<strong>ç´¯è®¡ç¡®è®¤</strong>æˆ–è€…<strong>ç´¯è®¡åº”ç­”</strong>ï¼ˆ<strong>cumulative acknowledgment</strong>ï¼‰ã€‚</p>
<p>ä¸ºäº†è®°å½•æ‰€æœ‰å‘é€çš„åŒ…å’Œæ¥æ”¶çš„åŒ…ï¼ŒTCPä¹Ÿéœ€è¦å‘é€ç«¯å’Œæ¥æ”¶ç«¯åˆ†åˆ«éƒ½æœ‰ç¼“å­˜æ¥ä¿å­˜è¿™äº›è®°å½•ã€‚å‘é€ç«¯çš„ç¼“å­˜é‡Œæ˜¯æŒ‰ç…§åŒ…çš„IDä¸€ä¸ªä¸ªæ’åˆ—ï¼Œæ ¹æ®å¤„ç†çš„æƒ…å†µåˆ†æˆå››ä¸ªéƒ¨åˆ†ã€‚</p>
<p>ç¬¬ä¸€éƒ¨åˆ†ï¼šå‘é€äº†å¹¶ä¸”å·²ç»ç¡®è®¤çš„ã€‚è¿™éƒ¨åˆ†å°±æ˜¯ä½ äº¤ä»£ä¸‹å±çš„ï¼Œå¹¶ä¸”ä¹Ÿåšå®Œäº†çš„ï¼Œåº”è¯¥åˆ’æ‰çš„ã€‚</p>
<p>ç¬¬äºŒéƒ¨åˆ†ï¼šå‘é€äº†å¹¶ä¸”å°šæœªç¡®è®¤çš„ã€‚è¿™éƒ¨åˆ†æ˜¯ä½ äº¤ä»£ä¸‹å±çš„ï¼Œä½†æ˜¯è¿˜æ²¡åšå®Œçš„ï¼Œéœ€è¦ç­‰å¾…åšå®Œçš„å›å¤ä¹‹åï¼Œæ‰èƒ½åˆ’æ‰ã€‚</p>
<p>ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ²¡æœ‰å‘é€ï¼Œä½†æ˜¯å·²ç»ç­‰å¾…å‘é€çš„ã€‚è¿™éƒ¨åˆ†æ˜¯ä½ è¿˜æ²¡æœ‰äº¤ä»£ç»™ä¸‹å±ï¼Œä½†æ˜¯é©¬ä¸Šå°±è¦äº¤ä»£çš„ã€‚</p>
<p>ç¬¬å››éƒ¨åˆ†ï¼šæ²¡æœ‰å‘é€ï¼Œå¹¶ä¸”æš‚æ—¶è¿˜ä¸ä¼šå‘é€çš„ã€‚è¿™éƒ¨åˆ†æ˜¯ä½ è¿˜æ²¡æœ‰äº¤ä»£ç»™ä¸‹å±ï¼Œè€Œä¸”æš‚æ—¶è¿˜ä¸ä¼šäº¤ä»£ç»™ä¸‹å±çš„ã€‚</p>
<p>è¿™é‡Œé¢ä¸ºä»€ä¹ˆè¦åŒºåˆ†ç¬¬ä¸‰éƒ¨åˆ†å’Œç¬¬å››éƒ¨åˆ†å‘¢ï¼Ÿæ²¡äº¤ä»£çš„ï¼Œä¸€ä¸‹å­å…¨äº¤ä»£äº†ä¸å°±å®Œäº†å—ï¼Ÿ</p>
<p>è¿™å°±æ˜¯æˆ‘ä»¬ä¸Šä¸€èŠ‚æåˆ°çš„åä¸ªè¯å£è¯€é‡Œçš„â€œæµé‡æ§åˆ¶ï¼ŒæŠŠæ¡åˆ†å¯¸â€ã€‚ä½œä¸ºé¡¹ç›®ç®¡ç†äººå‘˜ï¼Œä½ åº”è¯¥æ ¹æ®ä»¥å¾€çš„å·¥ä½œæƒ…å†µå’Œè¿™ä¸ªå‘˜å·¥åé¦ˆçš„èƒ½åŠ›ã€æŠ—å‹åŠ›ç­‰ï¼Œå…ˆåœ¨å¿ƒä¸­ä¼°æµ‹ä¸€ä¸‹ï¼Œè¿™ä¸ªäººä¸€å¤©èƒ½åšå¤šå°‘å·¥ä½œã€‚å¦‚æœå·¥ä½œå¸ƒç½®å°‘äº†ï¼Œå°±ä¼šä¸é¥±å’Œï¼›å¦‚æœå·¥ä½œå¸ƒç½®å¤šäº†ï¼Œä»–å°±ä¼šåšä¸å®Œï¼›å¦‚æœä½ ä½¿åŠ²é€¼è¿«ï¼Œäººå®¶å¯èƒ½å°±è¦è¾èŒäº†ã€‚</p>
<p>åˆ°åº•ä¸€ä¸ªå‘˜å·¥èƒ½å¤ŸåŒæ—¶å¤„ç†å¤šå°‘äº‹æƒ…å‘¢ï¼Ÿåœ¨TCPé‡Œï¼Œæ¥æ”¶ç«¯ä¼šç»™å‘é€ç«¯æŠ¥ä¸€ä¸ªçª—å£çš„å¤§å°ï¼Œå«<strong>Advertised window</strong>ã€‚è¿™ä¸ªçª—å£çš„å¤§å°åº”è¯¥ç­‰äºä¸Šé¢çš„ç¬¬äºŒéƒ¨åˆ†åŠ ä¸Šç¬¬ä¸‰éƒ¨åˆ†ï¼Œå°±æ˜¯å·²ç»äº¤ä»£äº†æ²¡åšå®Œçš„åŠ ä¸Šé©¬ä¸Šè¦äº¤ä»£çš„ã€‚è¶…è¿‡è¿™ä¸ªçª—å£çš„ï¼Œæ¥æ”¶ç«¯åšä¸è¿‡æ¥ï¼Œå°±ä¸èƒ½å‘é€äº†ã€‚</p>
<p>äºæ˜¯ï¼Œå‘é€ç«¯éœ€è¦ä¿æŒä¸‹é¢çš„æ•°æ®ç»“æ„ã€‚</p>
<!-- [[[read_end]]] -->
<p><img src="https://static001.geekbang.org/resource/image/16/7b/16dcd6fb8105a1caa75887b5ffa0bd7b.jpg" alt="">  </p>
<ul>
<li><p>LastByteAckedï¼šç¬¬ä¸€éƒ¨åˆ†å’Œç¬¬äºŒéƒ¨åˆ†çš„åˆ†ç•Œçº¿</p>
</li>
<li><p>LastByteSentï¼šç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†çš„åˆ†ç•Œçº¿</p>
</li>
<li><p>LastByteAcked + AdvertisedWindowï¼šç¬¬ä¸‰éƒ¨åˆ†å’Œç¬¬å››éƒ¨åˆ†çš„åˆ†ç•Œçº¿</p>
</li>
</ul>
<p>å¯¹äºæ¥æ”¶ç«¯æ¥è®²ï¼Œå®ƒçš„ç¼“å­˜é‡Œè®°å½•çš„å†…å®¹è¦ç®€å•ä¸€äº›ã€‚</p>
<p>ç¬¬ä¸€éƒ¨åˆ†ï¼šæ¥å—å¹¶ä¸”ç¡®è®¤è¿‡çš„ã€‚ä¹Ÿå°±æ˜¯æˆ‘é¢†å¯¼äº¤ä»£ç»™æˆ‘ï¼Œå¹¶ä¸”æˆ‘åšå®Œçš„ã€‚</p>
<p>ç¬¬äºŒéƒ¨åˆ†ï¼šè¿˜æ²¡æ¥æ”¶ï¼Œä½†æ˜¯é©¬ä¸Šå°±èƒ½æ¥æ”¶çš„ã€‚ä¹Ÿå³æ˜¯æˆ‘è‡ªå·±çš„èƒ½å¤Ÿæ¥å—çš„æœ€å¤§å·¥ä½œé‡ã€‚</p>
<p>ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¿˜æ²¡æ¥æ”¶ï¼Œä¹Ÿæ²¡æ³•æ¥æ”¶çš„ã€‚ä¹Ÿå³è¶…è¿‡å·¥ä½œé‡çš„éƒ¨åˆ†ï¼Œå®åœ¨åšä¸å®Œã€‚</p>
<p>å¯¹åº”çš„æ•°æ®ç»“æ„å°±åƒè¿™æ ·ã€‚
ï»¿ï»¿
<img src="https://static001.geekbang.org/resource/image/f7/a4/f7b1d3bc6b6d8e55f0951e82294c8ba4.jpg" alt=""></p>
<ul>
<li><p>MaxRcvBufferï¼šæœ€å¤§ç¼“å­˜çš„é‡ï¼›</p>
</li>
<li><p>LastByteReadä¹‹åæ˜¯å·²ç»æ¥æ”¶äº†ï¼Œä½†æ˜¯è¿˜æ²¡è¢«åº”ç”¨å±‚è¯»å–çš„ï¼›</p>
</li>
<li><p>NextByteExpectedæ˜¯ç¬¬ä¸€éƒ¨åˆ†å’Œç¬¬äºŒéƒ¨åˆ†çš„åˆ†ç•Œçº¿ã€‚</p>
</li>
</ul>
<p>ç¬¬äºŒéƒ¨åˆ†çš„çª—å£æœ‰å¤šå¤§å‘¢ï¼Ÿ</p>
<p>NextByteExpectedå’ŒLastByteReadçš„å·®å…¶å®æ˜¯è¿˜æ²¡è¢«åº”ç”¨å±‚è¯»å–çš„éƒ¨åˆ†å ç”¨æ‰çš„MaxRcvBufferçš„é‡ï¼Œæˆ‘ä»¬å®šä¹‰ä¸ºAã€‚</p>
<p>AdvertisedWindowå…¶å®æ˜¯MaxRcvBufferå‡å»Aã€‚</p>
<p>ä¹Ÿå°±æ˜¯ï¼šAdvertisedWindow=MaxRcvBuffer-((NextByteExpected-1)-LastByteRead)ã€‚</p>
<p>é‚£ç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†çš„åˆ†ç•Œçº¿åœ¨å“ªé‡Œå‘¢ï¼ŸNextByteExpectedåŠ AdvertisedWindowå°±æ˜¯ç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†çš„åˆ†ç•Œçº¿ï¼Œå…¶å®ä¹Ÿå°±æ˜¯LastByteReadåŠ ä¸ŠMaxRcvBufferã€‚</p>
<p>å…¶ä¸­ç¬¬äºŒéƒ¨åˆ†é‡Œé¢ï¼Œç”±äºå—åˆ°çš„åŒ…å¯èƒ½ä¸æ˜¯é¡ºåºçš„ï¼Œä¼šå‡ºç°ç©ºæŒ¡ï¼Œåªæœ‰å’Œç¬¬ä¸€éƒ¨åˆ†è¿ç»­çš„ï¼Œå¯ä»¥é©¬ä¸Šè¿›è¡Œå›å¤ï¼Œä¸­é—´ç©ºç€çš„éƒ¨åˆ†éœ€è¦ç­‰å¾…ï¼Œå“ªæ€•åé¢çš„å·²ç»æ¥äº†ã€‚</p>
<h2 id="-">é¡ºåºé—®é¢˜ä¸ä¸¢åŒ…é—®é¢˜</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»“åˆä¸€ä¸ªä¾‹å­æ¥çœ‹ã€‚</p>
<p>è¿˜æ˜¯åˆšæ‰çš„å›¾ï¼Œåœ¨å‘é€ç«¯æ¥çœ‹ï¼Œ1ã€2ã€3å·²ç»å‘é€å¹¶ç¡®è®¤ï¼›4ã€5ã€6ã€7ã€8ã€9éƒ½æ˜¯å‘é€äº†è¿˜æ²¡ç¡®è®¤ï¼›10ã€11ã€12æ˜¯è¿˜æ²¡å‘å‡ºçš„ï¼›13ã€14ã€15æ˜¯æ¥æ”¶æ–¹æ²¡æœ‰ç©ºé—´ï¼Œä¸å‡†å¤‡å‘çš„ã€‚</p>
<p>åœ¨æ¥æ”¶ç«¯æ¥çœ‹ï¼Œ1ã€2ã€3ã€4ã€5æ˜¯å·²ç»å®ŒæˆACKï¼Œä½†æ˜¯æ²¡è¯»å–çš„ï¼›6ã€7æ˜¯ç­‰å¾…æ¥æ”¶çš„ï¼›8ã€9æ˜¯å·²ç»æ¥æ”¶ï¼Œä½†æ˜¯æ²¡æœ‰ACKçš„ã€‚</p>
<p>å‘é€ç«¯å’Œæ¥æ”¶ç«¯å½“å‰çš„çŠ¶æ€å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>1ã€2ã€3æ²¡æœ‰é—®é¢˜ï¼ŒåŒæ–¹è¾¾æˆäº†ä¸€è‡´ã€‚</p>
</li>
<li><p>4ã€5æ¥æ”¶æ–¹è¯´ACKäº†ï¼Œä½†æ˜¯å‘é€æ–¹è¿˜æ²¡æ”¶åˆ°ï¼Œæœ‰å¯èƒ½ä¸¢äº†ï¼Œæœ‰å¯èƒ½åœ¨è·¯ä¸Šã€‚</p>
</li>
<li><p>6ã€7ã€8ã€9è‚¯å®šéƒ½å‘äº†ï¼Œä½†æ˜¯8ã€9å·²ç»åˆ°äº†ï¼Œä½†æ˜¯6ã€7æ²¡åˆ°ï¼Œå‡ºç°äº†ä¹±åºï¼Œç¼“å­˜ç€ä½†æ˜¯æ²¡åŠæ³•ACKã€‚</p>
</li>
</ul>
<p>æ ¹æ®è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œé¡ºåºé—®é¢˜å’Œä¸¢åŒ…é—®é¢˜éƒ½æœ‰å¯èƒ½å‘ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ¥çœ‹<strong>ç¡®è®¤ä¸é‡å‘çš„æœºåˆ¶</strong>ã€‚</p>
<p>å‡è®¾4çš„ç¡®è®¤åˆ°äº†ï¼Œä¸å¹¸çš„æ˜¯ï¼Œ5çš„ACKä¸¢äº†ï¼Œ6ã€7çš„æ•°æ®åŒ…ä¸¢äº†ï¼Œè¿™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>ä¸€ç§æ–¹æ³•å°±æ˜¯<strong>è¶…æ—¶é‡è¯•</strong>ï¼Œä¹Ÿå³å¯¹æ¯ä¸€ä¸ªå‘é€äº†ï¼Œä½†æ˜¯æ²¡æœ‰ACKçš„åŒ…ï¼Œéƒ½æœ‰è®¾ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¶…è¿‡äº†ä¸€å®šçš„æ—¶é—´ï¼Œå°±é‡æ–°å°è¯•ã€‚ä½†æ˜¯è¿™ä¸ªè¶…æ—¶çš„æ—¶é—´å¦‚ä½•è¯„ä¼°å‘¢ï¼Ÿè¿™ä¸ªæ—¶é—´ä¸å®œè¿‡çŸ­ï¼Œæ—¶é—´å¿…é¡»å¤§äºå¾€è¿”æ—¶é—´RTTï¼Œå¦åˆ™ä¼šå¼•èµ·ä¸å¿…è¦çš„é‡ä¼ ã€‚ä¹Ÿä¸å®œè¿‡é•¿ï¼Œè¿™æ ·è¶…æ—¶æ—¶é—´å˜é•¿ï¼Œè®¿é—®å°±å˜æ…¢äº†ã€‚</p>
<p>ä¼°è®¡å¾€è¿”æ—¶é—´ï¼Œéœ€è¦TCPé€šè¿‡é‡‡æ ·RTTçš„æ—¶é—´ï¼Œç„¶åè¿›è¡ŒåŠ æƒå¹³å‡ï¼Œç®—å‡ºä¸€ä¸ªå€¼ï¼Œè€Œä¸”è¿™ä¸ªå€¼è¿˜æ˜¯è¦ä¸æ–­å˜åŒ–çš„ï¼Œå› ä¸ºç½‘ç»œçŠ¶å†µä¸æ–­çš„å˜åŒ–ã€‚é™¤äº†é‡‡æ ·RTTï¼Œè¿˜è¦é‡‡æ ·RTTçš„æ³¢åŠ¨èŒƒå›´ï¼Œè®¡ç®—å‡ºä¸€ä¸ªä¼°è®¡çš„è¶…æ—¶æ—¶é—´ã€‚ç”±äºé‡ä¼ æ—¶é—´æ˜¯ä¸æ–­å˜åŒ–çš„ï¼Œæˆ‘ä»¬ç§°ä¸º<strong>è‡ªé€‚åº”é‡ä¼ ç®—æ³•</strong>ï¼ˆ<strong>Adaptive Retransmission Algorithm</strong>ï¼‰ã€‚</p>
<p>å¦‚æœè¿‡ä¸€æ®µæ—¶é—´ï¼Œ5ã€6ã€7éƒ½è¶…æ—¶äº†ï¼Œå°±ä¼šé‡æ–°å‘é€ã€‚æ¥æ”¶æ–¹å‘ç°5åŸæ¥æ¥æ”¶è¿‡ï¼Œäºæ˜¯ä¸¢å¼ƒ5ï¼›6æ”¶åˆ°äº†ï¼Œå‘é€ACKï¼Œè¦æ±‚ä¸‹ä¸€ä¸ªæ˜¯7ï¼Œ7ä¸å¹¸åˆä¸¢äº†ã€‚å½“7å†æ¬¡è¶…æ—¶çš„æ—¶å€™ï¼Œæœ‰éœ€è¦é‡ä¼ çš„æ—¶å€™ï¼ŒTCPçš„ç­–ç•¥æ˜¯<strong>è¶…æ—¶é—´éš”åŠ å€</strong>ã€‚<strong>æ¯å½“é‡åˆ°ä¸€æ¬¡è¶…æ—¶é‡ä¼ çš„æ—¶å€™ï¼Œéƒ½ä¼šå°†ä¸‹ä¸€æ¬¡è¶…æ—¶æ—¶é—´é—´éš”è®¾ä¸ºå…ˆå‰å€¼çš„ä¸¤å€</strong>ã€‚<strong>ä¸¤æ¬¡è¶…æ—¶ï¼Œå°±è¯´æ˜ç½‘ç»œç¯å¢ƒå·®ï¼Œä¸å®œé¢‘ç¹åå¤å‘é€ã€‚</strong></p>
<p>è¶…æ—¶è§¦å‘é‡ä¼ å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼Œè¶…æ—¶å‘¨æœŸå¯èƒ½ç›¸å¯¹è¾ƒé•¿ã€‚é‚£æ˜¯ä¸æ˜¯å¯ä»¥æœ‰æ›´å¿«çš„æ–¹å¼å‘¢ï¼Ÿ</p>
<p>æœ‰ä¸€ä¸ªå¯ä»¥å¿«é€Ÿé‡ä¼ çš„æœºåˆ¶ï¼Œå½“æ¥æ”¶æ–¹æ”¶åˆ°ä¸€ä¸ªåºå·å¤§äºä¸‹ä¸€ä¸ªæ‰€æœŸæœ›çš„æŠ¥æ–‡æ®µæ—¶ï¼Œå°±æ£€æµ‹åˆ°äº†æ•°æ®æµä¸­çš„ä¸€ä¸ªé—´æ ¼ï¼Œäºæ˜¯å‘é€ä¸‰ä¸ªå†—ä½™çš„ACKï¼Œå®¢æˆ·ç«¯æ”¶åˆ°åï¼Œå°±åœ¨å®šæ—¶å™¨è¿‡æœŸä¹‹å‰ï¼Œé‡ä¼ ä¸¢å¤±çš„æŠ¥æ–‡æ®µã€‚</p>
<p>ä¾‹å¦‚ï¼Œæ¥æ”¶æ–¹å‘ç°6ã€8ã€9éƒ½å·²ç»æ¥æ”¶äº†ï¼Œå°±æ˜¯7æ²¡æ¥ï¼Œé‚£è‚¯å®šæ˜¯ä¸¢äº†ï¼Œäºæ˜¯å‘é€ä¸‰ä¸ª6çš„ACKï¼Œè¦æ±‚ä¸‹ä¸€ä¸ªæ˜¯7ã€‚å®¢æˆ·ç«¯æ”¶åˆ°3ä¸ªï¼Œå°±ä¼šå‘ç°7çš„ç¡®åˆä¸¢äº†ï¼Œä¸ç­‰è¶…æ—¶ï¼Œé©¬ä¸Šé‡å‘ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æ–¹å¼ç§°ä¸º<strong>Selective Acknowledgment</strong>  ï¼ˆ<strong>SACK</strong>ï¼‰ã€‚è¿™ç§æ–¹å¼éœ€è¦åœ¨TCPå¤´é‡ŒåŠ ä¸€ä¸ªSACKçš„ä¸œè¥¿ï¼Œå¯ä»¥å°†ç¼“å­˜çš„åœ°å›¾å‘é€ç»™å‘é€æ–¹ã€‚ä¾‹å¦‚å¯ä»¥å‘é€ACK6ã€SACK8ã€SACK9ï¼Œæœ‰äº†åœ°å›¾ï¼Œå‘é€æ–¹ä¸€ä¸‹å­å°±èƒ½çœ‹å‡ºæ¥æ˜¯7ä¸¢äº†ã€‚</p>
<h2 id="-">æµé‡æ§åˆ¶é—®é¢˜</h2>
<p>æˆ‘ä»¬å†æ¥çœ‹æµé‡æ§åˆ¶æœºåˆ¶ï¼Œåœ¨å¯¹äºåŒ…çš„ç¡®è®¤ä¸­ï¼ŒåŒæ—¶ä¼šæºå¸¦ä¸€ä¸ªçª—å£çš„å¤§å°ã€‚</p>
<p>æˆ‘ä»¬å…ˆå‡è®¾çª—å£ä¸å˜çš„æƒ…å†µï¼Œçª—å£å§‹ç»ˆä¸º9ã€‚4çš„ç¡®è®¤æ¥çš„æ—¶å€™ï¼Œä¼šå³ç§»ä¸€ä¸ªï¼Œè¿™ä¸ªæ—¶å€™ç¬¬13ä¸ªåŒ…ä¹Ÿå¯ä»¥å‘é€äº†ã€‚</p>
<p><img src="https://static001.geekbang.org/resource/image/73/33/7339fd8973865164d25227cac206ca33.jpg" alt=""></p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œå‡è®¾å‘é€ç«¯å‘é€è¿‡çŒ›ï¼Œä¼šå°†ç¬¬ä¸‰éƒ¨åˆ†çš„10ã€11ã€12ã€13å…¨éƒ¨å‘é€å®Œæ¯•ï¼Œä¹‹åå°±åœæ­¢å‘é€äº†ï¼Œæœªå‘é€å¯å‘é€éƒ¨åˆ†ä¸º0ã€‚</p>
<p><img src="https://static001.geekbang.org/resource/image/06/d2/06cc25118730fbf611eb315705420ed2.jpg" alt="">  </p>
<p>å½“å¯¹äºåŒ…5çš„ç¡®è®¤åˆ°è¾¾çš„æ—¶å€™ï¼Œåœ¨å®¢æˆ·ç«¯ç›¸å½“äºçª—å£å†æ»‘åŠ¨äº†ä¸€æ ¼ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ‰å¯ä»¥æœ‰æ›´å¤šçš„åŒ…å¯ä»¥å‘é€äº†ï¼Œä¾‹å¦‚ç¬¬14ä¸ªåŒ…æ‰å¯ä»¥å‘é€ã€‚</p>
<p> <img src="https://static001.geekbang.org/resource/image/bd/c3/bddb59ebbf7eecc4853cafce0bb1dcc3.jpg" alt="">  </p>
<p>å¦‚æœæ¥æ”¶æ–¹å®åœ¨å¤„ç†çš„å¤ªæ…¢ï¼Œå¯¼è‡´ç¼“å­˜ä¸­æ²¡æœ‰ç©ºé—´äº†ï¼Œå¯ä»¥é€šè¿‡ç¡®è®¤ä¿¡æ¯ä¿®æ”¹çª—å£çš„å¤§å°ï¼Œç”šè‡³å¯ä»¥è®¾ç½®ä¸º0ï¼Œåˆ™å‘é€æ–¹å°†æš‚æ—¶åœæ­¢å‘é€ã€‚</p>
<p>æˆ‘ä»¬å‡è®¾ä¸€ä¸ªæç«¯æƒ…å†µï¼Œæ¥æ”¶ç«¯çš„åº”ç”¨ä¸€ç›´ä¸è¯»å–ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œå½“æ•°æ®åŒ…6ç¡®è®¤åï¼Œçª—å£å¤§å°å°±ä¸èƒ½å†æ˜¯9äº†ï¼Œå°±è¦ç¼©å°ä¸€ä¸ªå˜ä¸º8ã€‚</p>
<p><img src="https://static001.geekbang.org/resource/image/92/31/92f66b1556b76c46c669aba232d35a31.jpg" alt="">  </p>
<p>è¿™ä¸ªæ–°çš„çª—å£8é€šè¿‡6çš„ç¡®è®¤æ¶ˆæ¯åˆ°è¾¾å‘é€ç«¯çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°çª—å£æ²¡æœ‰å¹³è¡Œå³ç§»ï¼Œè€Œæ˜¯ä»…ä»…å·¦é¢çš„è¾¹å³ç§»äº†ï¼Œçª—å£çš„å¤§å°ä»9æ”¹æˆäº†8ã€‚</p>
<p><img src="https://static001.geekbang.org/resource/image/a7/ba/a78f5195ebf9b4f9dc4ea5a9b91e94ba.jpg" alt=""></p>
<p>å¦‚æœæ¥æ”¶ç«¯è¿˜æ˜¯ä¸€ç›´ä¸å¤„ç†æ•°æ®ï¼Œåˆ™éšç€ç¡®è®¤çš„åŒ…è¶Šæ¥è¶Šå¤šï¼Œçª—å£è¶Šæ¥è¶Šå°ï¼Œç›´åˆ°ä¸º0ã€‚</p>
<p><img src="https://static001.geekbang.org/resource/image/15/d2/150f28d9e745952f5968eff05e3f0ad2.jpg" alt="">  </p>
<p>å½“è¿™ä¸ªçª—å£é€šè¿‡åŒ…14çš„ç¡®è®¤åˆ°è¾¾å‘é€ç«¯çš„æ—¶å€™ï¼Œå‘é€ç«¯çš„çª—å£ä¹Ÿè°ƒæ•´ä¸º0ï¼Œåœæ­¢å‘é€ã€‚</p>
<p><img src="https://static001.geekbang.org/resource/image/30/30/3014a6a259f74b0c950bf3067581ac30.jpg" alt="">  </p>
<p>å¦‚æœè¿™æ ·çš„è¯ï¼Œå‘é€æ–¹ä¼šå®šæ—¶å‘é€çª—å£æ¢æµ‹æ•°æ®åŒ…ï¼Œçœ‹æ˜¯å¦æœ‰æœºä¼šè°ƒæ•´çª—å£çš„å¤§å°ã€‚å½“æ¥æ”¶æ–¹æ¯”è¾ƒæ…¢çš„æ—¶å€™ï¼Œè¦é˜²æ­¢ä½èƒ½çª—å£ç»¼åˆå¾ï¼Œåˆ«ç©ºå‡ºä¸€ä¸ªå­—èŠ‚æ¥å°±èµ¶å¿«å‘Šè¯‰å‘é€æ–¹ï¼Œç„¶åé©¬ä¸Šåˆå¡«æ»¡äº†ï¼Œå¯ä»¥å½“çª—å£å¤ªå°çš„æ—¶å€™ï¼Œä¸æ›´æ–°çª—å£ï¼Œç›´åˆ°è¾¾åˆ°ä¸€å®šå¤§å°ï¼Œæˆ–è€…ç¼“å†²åŒºä¸€åŠä¸ºç©ºï¼Œæ‰æ›´æ–°çª—å£ã€‚</p>
<p>è¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æµé‡æ§åˆ¶ã€‚</p>
<h2 id="-">æ‹¥å¡æ§åˆ¶é—®é¢˜</h2>
<p>æœ€åï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹æ‹¥å¡æ§åˆ¶çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯é€šè¿‡çª—å£çš„å¤§å°æ¥æ§åˆ¶çš„ï¼Œå‰é¢çš„æ»‘åŠ¨çª—å£rwndæ˜¯æ€•å‘é€æ–¹æŠŠæ¥æ”¶æ–¹ç¼“å­˜å¡æ»¡ï¼Œè€Œæ‹¥å¡çª—å£cwndï¼Œæ˜¯æ€•æŠŠç½‘ç»œå¡æ»¡ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå…¬å¼ LastByteSent - LastByteAcked &lt;= min {cwnd, rwnd} ï¼Œæ˜¯æ‹¥å¡çª—å£å’Œæ»‘åŠ¨çª—å£å…±åŒæ§åˆ¶å‘é€çš„é€Ÿåº¦ã€‚</p>
<p>é‚£å‘é€æ–¹æ€ä¹ˆåˆ¤æ–­ç½‘ç»œæ˜¯ä¸æ˜¯æ»¡å‘¢ï¼Ÿè¿™å…¶å®æ˜¯ä¸ªæŒºéš¾çš„äº‹æƒ…ï¼Œå› ä¸ºå¯¹äºTCPåè®®æ¥è®²ï¼Œä»–å‹æ ¹ä¸çŸ¥é“æ•´ä¸ªç½‘ç»œè·¯å¾„éƒ½ä¼šç»å†ä»€ä¹ˆï¼Œå¯¹ä»–æ¥è®²å°±æ˜¯ä¸€ä¸ªé»‘ç›’ã€‚TCPå‘é€åŒ…å¸¸è¢«æ¯”å–»ä¸ºå¾€ä¸€ä¸ªæ°´ç®¡é‡Œé¢çŒæ°´ï¼Œè€ŒTCPçš„æ‹¥å¡æ§åˆ¶å°±æ˜¯åœ¨ä¸å µå¡ï¼Œä¸ä¸¢åŒ…çš„æƒ…å†µä¸‹ï¼Œå°½é‡å‘æŒ¥å¸¦å®½ã€‚</p>
<p>æ°´ç®¡æœ‰ç²—ç»†ï¼Œç½‘ç»œæœ‰å¸¦å®½ï¼Œä¹Ÿå³æ¯ç§’é’Ÿèƒ½å¤Ÿå‘é€å¤šå°‘æ•°æ®ï¼›æ°´ç®¡æœ‰é•¿åº¦ï¼Œç«¯åˆ°ç«¯æœ‰æ—¶å»¶ã€‚åœ¨ç†æƒ³çŠ¶æ€ä¸‹ï¼Œæ°´ç®¡é‡Œé¢æ°´çš„é‡=æ°´ç®¡ç²—ç»† x æ°´ç®¡é•¿åº¦ã€‚å¯¹äºåˆ°ç½‘ç»œä¸Šï¼Œé€šé“çš„å®¹é‡ = å¸¦å®½ Ã— å¾€è¿”å»¶è¿Ÿã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è®¾ç½®å‘é€çª—å£ï¼Œä½¿å¾—å‘é€ä½†æœªç¡®è®¤çš„åŒ…ä¸ºä¸ºé€šé“çš„å®¹é‡ï¼Œå°±èƒ½å¤Ÿæ’‘æ»¡æ•´ä¸ªç®¡é“ã€‚</p>
<p><img src="https://static001.geekbang.org/resource/image/db/e6/db8510541662281175803c7f9d1fcae6.jpg" alt=""></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œå‡è®¾å¾€è¿”æ—¶é—´ä¸º8sï¼Œå»4sï¼Œå›4sï¼Œæ¯ç§’å‘é€ä¸€ä¸ªåŒ…ï¼Œæ¯ä¸ªåŒ…1024byteã€‚å·²ç»è¿‡å»äº†8sï¼Œåˆ™8ä¸ªåŒ…éƒ½å‘å‡ºå»äº†ï¼Œå…¶ä¸­å‰4ä¸ªåŒ…å·²ç»åˆ°è¾¾æ¥æ”¶ç«¯ï¼Œä½†æ˜¯ACKè¿˜æ²¡æœ‰è¿”å›ï¼Œä¸èƒ½ç®—å‘é€æˆåŠŸã€‚5-8åå››ä¸ªåŒ…è¿˜åœ¨è·¯ä¸Šï¼Œè¿˜æ²¡è¢«æ¥æ”¶ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæ•´ä¸ªç®¡é“æ­£å¥½æ’‘æ»¡ï¼Œåœ¨å‘é€ç«¯ï¼Œå·²å‘é€æœªç¡®è®¤çš„ä¸º8ä¸ªåŒ…ï¼Œæ­£å¥½ç­‰äºå¸¦å®½ï¼Œä¹Ÿå³æ¯ç§’å‘é€1ä¸ªåŒ…ï¼Œä¹˜ä»¥æ¥å›æ—¶é—´8sã€‚</p>
<p>å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå†è°ƒå¤§çª—å£ï¼Œä½¿å¾—å•ä½æ—¶é—´å†…æ›´å¤šçš„åŒ…å¯ä»¥å‘é€ï¼Œä¼šå‡ºç°ä»€ä¹ˆç°è±¡å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æ¥æƒ³ï¼ŒåŸæ¥å‘é€ä¸€ä¸ªåŒ…ï¼Œä»ä¸€ç«¯åˆ°è¾¾å¦ä¸€ç«¯ï¼Œå‡è®¾ä¸€å…±ç»è¿‡å››ä¸ªè®¾å¤‡ï¼Œæ¯ä¸ªè®¾å¤‡å¤„ç†ä¸€ä¸ªåŒ…æ—¶é—´è€—è´¹1sï¼Œæ‰€ä»¥åˆ°è¾¾å¦ä¸€ç«¯éœ€è¦è€—è´¹4sï¼Œå¦‚æœå‘é€çš„æ›´åŠ å¿«é€Ÿï¼Œåˆ™å•ä½æ—¶é—´å†…ï¼Œä¼šæœ‰æ›´å¤šçš„åŒ…åˆ°è¾¾è¿™äº›ä¸­é—´è®¾å¤‡ï¼Œè¿™äº›è®¾å¤‡è¿˜æ˜¯åªèƒ½æ¯ç§’å¤„ç†ä¸€ä¸ªåŒ…çš„è¯ï¼Œå¤šå‡ºæ¥çš„åŒ…å°±ä¼šè¢«ä¸¢å¼ƒï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æƒ³çœ‹åˆ°çš„ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³å…¶ä»–çš„åŠæ³•ï¼Œä¾‹å¦‚è¿™ä¸ªå››ä¸ªè®¾å¤‡æœ¬æ¥æ¯ç§’å¤„ç†ä¸€ä¸ªåŒ…ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¿™äº›è®¾å¤‡ä¸ŠåŠ ç¼“å­˜ï¼Œå¤„ç†ä¸è¿‡æ¥çš„åœ¨é˜Ÿåˆ—é‡Œé¢æ’ç€ï¼Œè¿™æ ·åŒ…å°±ä¸ä¼šä¸¢å¤±ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯ä¼šå¢åŠ æ—¶å»¶ï¼Œè¿™ä¸ªç¼“å­˜çš„åŒ…ï¼Œ4sè‚¯å®šåˆ°è¾¾ä¸äº†æ¥æ”¶ç«¯äº†ï¼Œå¦‚æœæ—¶å»¶è¾¾åˆ°ä¸€å®šç¨‹åº¦ï¼Œå°±ä¼šè¶…æ—¶é‡ä¼ ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä¸æƒ³çœ‹åˆ°çš„ã€‚</p>
<p>äºæ˜¯TCPçš„æ‹¥å¡æ§åˆ¶ä¸»è¦æ¥é¿å…ä¸¤ç§ç°è±¡ï¼Œ<strong>åŒ…ä¸¢å¤±</strong>å’Œ<strong>è¶…æ—¶é‡ä¼ </strong>ã€‚ä¸€æ—¦å‡ºç°äº†è¿™äº›ç°è±¡å°±è¯´æ˜ï¼Œå‘é€é€Ÿåº¦å¤ªå¿«äº†ï¼Œè¦æ…¢ä¸€ç‚¹ã€‚ä½†æ˜¯ä¸€å¼€å§‹æˆ‘æ€ä¹ˆçŸ¥é“é€Ÿåº¦å¤šå¿«å‘¢ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“åº”è¯¥æŠŠçª—å£è°ƒæ•´åˆ°å¤šå¤§å‘¢ï¼Ÿ</p>
<p>å¦‚æœæˆ‘ä»¬é€šè¿‡æ¼æ–—å¾€ç“¶å­é‡ŒçŒæ°´ï¼Œæˆ‘ä»¬å°±çŸ¥é“ï¼Œä¸èƒ½ä¸€æ¡¶æ°´ä¸€ä¸‹å­å€’è¿›å»ï¼Œè‚¯å®šä¼šæº…å‡ºæ¥ï¼Œè¦ä¸€å¼€å§‹æ…¢æ…¢çš„å€’ï¼Œç„¶åå‘ç°æ€»èƒ½å¤Ÿå€’è¿›å»ï¼Œå°±å¯ä»¥è¶Šå€’è¶Šå¿«ã€‚è¿™å«ä½œæ…¢å¯åŠ¨ã€‚</p>
<p>ä¸€æ¡TCPè¿æ¥å¼€å§‹ï¼Œcwndè®¾ç½®ä¸ºä¸€ä¸ªæŠ¥æ–‡æ®µï¼Œä¸€æ¬¡åªèƒ½å‘é€ä¸€ä¸ªï¼›å½“æ”¶åˆ°è¿™ä¸€ä¸ªç¡®è®¤çš„æ—¶å€™ï¼ŒcwndåŠ ä¸€ï¼Œäºæ˜¯ä¸€æ¬¡èƒ½å¤Ÿå‘é€ä¸¤ä¸ªï¼›å½“è¿™ä¸¤ä¸ªçš„ç¡®è®¤åˆ°æ¥çš„æ—¶å€™ï¼Œæ¯ä¸ªç¡®è®¤cwndåŠ ä¸€ï¼Œä¸¤ä¸ªç¡®è®¤cwndåŠ äºŒï¼Œäºæ˜¯ä¸€æ¬¡èƒ½å¤Ÿå‘é€å››ä¸ªï¼›å½“è¿™å››ä¸ªçš„ç¡®è®¤åˆ°æ¥çš„æ—¶å€™ï¼Œæ¯ä¸ªç¡®è®¤cwndåŠ ä¸€ï¼Œå››ä¸ªç¡®è®¤cwndåŠ å››ï¼Œäºæ˜¯ä¸€æ¬¡èƒ½å¤Ÿå‘é€å…«ä¸ªã€‚å¯ä»¥çœ‹å‡ºè¿™æ˜¯<strong>æŒ‡æ•°æ€§çš„å¢é•¿</strong>ã€‚</p>
<p>æ¶¨åˆ°ä»€ä¹ˆæ—¶å€™æ˜¯ä¸ªå¤´å‘¢ï¼Ÿæœ‰ä¸€ä¸ªå€¼ssthreshä¸º65535ä¸ªå­—èŠ‚ï¼Œå½“è¶…è¿‡è¿™ä¸ªå€¼çš„æ—¶å€™ï¼Œå°±è¦å°å¿ƒä¸€ç‚¹äº†ï¼Œä¸èƒ½å€’è¿™ä¹ˆå¿«äº†ï¼Œå¯èƒ½å¿«æ»¡äº†ï¼Œå†æ…¢ä¸‹æ¥ã€‚</p>
<p>æ¯æ”¶åˆ°ä¸€ä¸ªç¡®è®¤åï¼Œcwndå¢åŠ 1/cwndï¼Œæˆ‘ä»¬æ¥ç€ä¸Šé¢çš„è¿‡ç¨‹æ¥ï¼Œä¸€æ¬¡å‘é€å…«ä¸ªï¼Œå½“å…«ä¸ªç¡®è®¤åˆ°æ¥çš„æ—¶å€™ï¼Œæ¯ä¸ªç¡®è®¤å¢åŠ 1/8ï¼Œå…«ä¸ªç¡®è®¤ä¸€å…±cwndå¢åŠ 1ï¼Œäºæ˜¯ä¸€æ¬¡èƒ½å¤Ÿå‘é€ä¹ä¸ªï¼Œå˜æˆäº†çº¿æ€§å¢é•¿ã€‚</p>
<p>ä½†æ˜¯çº¿æ€§å¢é•¿è¿˜æ˜¯å¢é•¿ï¼Œè¿˜æ˜¯è¶Šæ¥è¶Šå¤šï¼Œç›´åˆ°æœ‰ä¸€å¤©ï¼Œæ°´æ»¡åˆ™æº¢ï¼Œå‡ºç°äº†æ‹¥å¡ï¼Œè¿™æ—¶å€™ä¸€èˆ¬å°±ä¼šä¸€ä¸‹å­é™ä½å€’æ°´çš„é€Ÿåº¦ï¼Œç­‰å¾…æº¢å‡ºçš„æ°´æ…¢æ…¢æ¸—ä¸‹å»ã€‚</p>
<p>æ‹¥å¡çš„ä¸€ç§è¡¨ç°å½¢å¼æ˜¯ä¸¢åŒ…ï¼Œéœ€è¦è¶…æ—¶é‡ä¼ ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°†sshreshè®¾ä¸ºcwnd/2ï¼Œå°†cwndè®¾ä¸º1ï¼Œé‡æ–°å¼€å§‹æ…¢å¯åŠ¨ã€‚è¿™çœŸæ˜¯ä¸€æ—¦è¶…æ—¶é‡ä¼ ï¼Œé©¬ä¸Šå›åˆ°è§£æ”¾å‰ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å¤ªæ¿€è¿›äº†ï¼Œå°†ä¸€ä¸ªé«˜é€Ÿçš„ä¼ è¾“é€Ÿåº¦ä¸€ä¸‹å­åœäº†ä¸‹æ¥ï¼Œä¼šé€ æˆç½‘ç»œå¡é¡¿ã€‚</p>
<p>å‰é¢æˆ‘ä»¬è®²è¿‡<strong>å¿«é€Ÿé‡ä¼ ç®—æ³•</strong>ã€‚å½“æ¥æ”¶ç«¯å‘ç°ä¸¢äº†ä¸€ä¸ªä¸­é—´åŒ…çš„æ—¶å€™ï¼Œå‘é€ä¸‰æ¬¡å‰ä¸€ä¸ªåŒ…çš„ACKï¼Œäºæ˜¯å‘é€ç«¯å°±ä¼šå¿«é€Ÿçš„é‡ä¼ ï¼Œä¸å¿…ç­‰å¾…è¶…æ—¶å†é‡ä¼ ã€‚TCPè®¤ä¸ºè¿™ç§æƒ…å†µä¸ä¸¥é‡ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æ²¡ä¸¢ï¼Œåªä¸¢äº†ä¸€å°éƒ¨åˆ†ï¼Œcwndå‡åŠä¸ºcwnd/2ï¼Œç„¶åsshthresh = cwndï¼Œå½“ä¸‰ä¸ªåŒ…è¿”å›çš„æ—¶å€™ï¼Œcwnd = sshthresh + 3ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¸€å¤œå›åˆ°è§£æ”¾å‰ï¼Œè€Œæ˜¯è¿˜åœ¨æ¯”è¾ƒé«˜çš„å€¼ï¼Œå‘ˆçº¿æ€§å¢é•¿ã€‚</p>
<p><img src="https://static001.geekbang.org/resource/image/19/d2/1910bc1a0048d4de7b2128eb0f5dbcd2.jpg" alt="">  </p>
<p>å°±åƒå‰é¢è¯´çš„ä¸€æ ·ï¼Œæ­£æ˜¯è¿™ç§çŸ¥è¿›é€€ï¼Œä½¿å¾—æ—¶å»¶å¾ˆé‡è¦çš„æƒ…å†µä¸‹ï¼Œåè€Œé™ä½äº†é€Ÿåº¦ã€‚ä½†æ˜¯å¦‚æœä½ ä»”ç»†æƒ³ä¸€ä¸‹ï¼ŒTCPçš„æ‹¥å¡æ§åˆ¶ä¸»è¦æ¥é¿å…çš„ä¸¤ä¸ªç°è±¡éƒ½æ˜¯æœ‰é—®é¢˜çš„ã€‚</p>
<p><strong>ç¬¬ä¸€ä¸ªé—®é¢˜</strong>æ˜¯ä¸¢åŒ…å¹¶ä¸ä»£è¡¨ç€é€šé“æ»¡äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯ç®¡å­æœ¬æ¥å°±æ¼æ°´ã€‚ä¾‹å¦‚å…¬ç½‘ä¸Šå¸¦å®½ä¸æ»¡ä¹Ÿä¼šä¸¢åŒ…ï¼Œè¿™ä¸ªæ—¶å€™å°±è®¤ä¸ºæ‹¥å¡äº†ï¼Œé€€ç¼©äº†ï¼Œå…¶å®æ˜¯ä¸å¯¹çš„ã€‚</p>
<p><strong>ç¬¬äºŒä¸ªé—®é¢˜</strong>æ˜¯TCPçš„æ‹¥å¡æ§åˆ¶è¦ç­‰åˆ°å°†ä¸­é—´è®¾å¤‡éƒ½å¡«å……æ»¡äº†ï¼Œæ‰å‘ç”Ÿä¸¢åŒ…ï¼Œä»è€Œé™ä½é€Ÿåº¦ï¼Œè¿™æ—¶å€™å·²ç»æ™šäº†ã€‚å…¶å®TCPåªè¦å¡«æ»¡ç®¡é“å°±å¯ä»¥äº†ï¼Œä¸åº”è¯¥æ¥ç€å¡«ï¼Œç›´åˆ°è¿ç¼“å­˜ä¹Ÿå¡«æ»¡ã€‚</p>
<p>ä¸ºäº†ä¼˜åŒ–è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œåæ¥æœ‰äº†<strong>TCP BBRæ‹¥å¡ç®—æ³•</strong>ã€‚å®ƒä¼å›¾æ‰¾åˆ°ä¸€ä¸ªå¹³è¡¡ç‚¹ï¼Œå°±æ˜¯é€šè¿‡ä¸æ–­çš„åŠ å¿«å‘é€é€Ÿåº¦ï¼Œå°†ç®¡é“å¡«æ»¡ï¼Œä½†æ˜¯ä¸è¦å¡«æ»¡ä¸­é—´è®¾å¤‡çš„ç¼“å­˜ï¼Œå› ä¸ºè¿™æ ·æ—¶å»¶ä¼šå¢åŠ ï¼Œåœ¨è¿™ä¸ªå¹³è¡¡ç‚¹å¯ä»¥å¾ˆå¥½çš„è¾¾åˆ°é«˜å¸¦å®½å’Œä½æ—¶å»¶çš„å¹³è¡¡ã€‚</p>
<p><img src="https://static001.geekbang.org/resource/image/a2/4c/a2b3a5df5eca52e302b75824e4bbbd4c.jpg" alt=""></p>
<h2 id="-">å°ç»“</h2>
<p>å¥½äº†ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬å°±åˆ°è¿™é‡Œï¼Œæ€»ç»“ä¸€ä¸‹ï¼š</p>
<ul>
<li><p>é¡ºåºé—®é¢˜ã€ä¸¢åŒ…é—®é¢˜ã€æµé‡æ§åˆ¶éƒ½æ˜¯é€šè¿‡æ»‘åŠ¨çª—å£æ¥è§£å†³çš„ï¼Œè¿™å…¶å®å°±ç›¸å½“äºä½ é¢†å¯¼å’Œä½ çš„å·¥ä½œå¤‡å¿˜å½•ï¼Œå¸ƒç½®è¿‡çš„å·¥ä½œè¦æœ‰ç¼–å·ï¼Œå¹²å®Œäº†æœ‰åé¦ˆï¼Œæ´»ä¸èƒ½æ´¾å¤ªå¤šï¼Œä¹Ÿä¸èƒ½å¤ªå°‘ï¼›</p>
</li>
<li><p>æ‹¥å¡æ§åˆ¶æ˜¯é€šè¿‡æ‹¥å¡çª—å£æ¥è§£å†³çš„ï¼Œç›¸å½“äºå¾€ç®¡é“é‡Œé¢å€’æ°´ï¼Œå¿«äº†å®¹æ˜“æº¢å‡ºï¼Œæ…¢äº†æµªè´¹å¸¦å®½ï¼Œè¦æ‘¸ç€çŸ³å¤´è¿‡æ²³ï¼Œæ‰¾åˆ°æœ€ä¼˜å€¼ã€‚</p>
</li>
</ul>
<p>æœ€åç•™ä¸¤ä¸ªæ€è€ƒé¢˜ï¼š</p>
<ol>
<li><p>TCPçš„BBRå¬èµ·æ¥å¾ˆç‰›ï¼Œä½ çŸ¥é“ä»–æ˜¯å¦‚ä½•è¾¾åˆ°è¿™ä¸ªæœ€ä¼˜ç‚¹çš„å˜›ï¼Ÿ</p>
</li>
<li><p>å­¦ä¼šäº†UDPå’ŒTCPï¼Œä½ çŸ¥é“å¦‚ä½•åŸºäºè¿™ä¸¤ç§åè®®å†™ç¨‹åºå—ï¼Ÿè¿™æ ·çš„ç¨‹åºä¼šæœ‰ä»€ä¹ˆå‘å‘¢ï¼Ÿ</p>
</li>
</ol>
<p>æ¬¢è¿ä½ ç•™è¨€å’Œæˆ‘è®¨è®ºã€‚è¶£è°ˆç½‘ç»œåè®®ï¼Œæˆ‘ä»¬ä¸‹æœŸè§ï¼</p>
<p><img src="https://static001.geekbang.org/resource/image/b5/fb/b5bc14cb81d3630919fee94a512cc3fb.jpg" alt=""></p>

                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/87/dd/4f53f95d.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è¿›é˜¶çš„ç å†œ</span>
                            </div>
                            <div class="bd">AdvertisedWindow=MaxRcvBuffer-((NextByteExpected-1)-LastByteRead)ã€‚<br>æˆ‘æ ¹æ®å›¾ä¸­ä¾‹å­è®¡ç®— 14-((5-1)-0) ç®—å‡ºæ¥æ˜¯10 ï¼Œæ‹¬å·é‡Œè¾¹çš„-1æ˜¯å‡çš„ä»€ä¹ˆï¼Œä¸ºå•¥å’Œå›¾ä¾‹ç®—å‡ºæ¥çš„ç»“æœä¸ä¸€æ ·ï¼Œè¿˜æ˜¯æˆ‘è®¡ç®—çš„æœ‰é—®é¢˜ï¼Œéº»çƒ¦è¯¦ç»†è¯´ä¸€ä¸‹ è°¢è°¢ <br></div>
                            <span class="time">2018-06-13 11:07</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™é‡Œæˆ‘å†™çš„çš„ç¡®æœ‰é—®é¢˜ï¼Œnextbyteexpectedå…¶å®æ˜¯6ï¼Œå°±æ˜¯ç›®å‰æ¥æ”¶åˆ°äº”ï¼Œä¸‹ä¸€ä¸ªæœŸæœ›çš„æ˜¯å…­ï¼Œè¿™æ ·å°±å¯¹äº†</p>
                                <p class="reply-time">2018-06-13 13:23</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">qpm</span>
                            </div>
                            <div class="bd">1 è®¾å¤‡ç¼“å­˜ä¼šå¯¼è‡´å»¶æ—¶ï¼Ÿ<br>	å‡å¦‚ç»è¿‡è®¾å¤‡çš„åŒ…éƒ½ä¸éœ€è¦è¿›å…¥ç¼“å­˜ï¼Œé‚£ä¹ˆå¾—åˆ°çš„é€Ÿåº¦æ˜¯æœ€å¿«çš„ã€‚è¿›å…¥ç¼“å­˜ä¸”ç­‰å¾…ï¼Œç­‰å¾…çš„æ—¶é—´å°±æ˜¯é¢å¤–çš„å»¶æ—¶ã€‚BBRå°±æ˜¯ä¸ºäº†é¿å…è¿™äº›é—®é¢˜ï¼š<br>	å……åˆ†åˆ©ç”¨å¸¦å®½ï¼›é™ä½bufferå ç”¨ç‡ã€‚<br><br>2 é™ä½å‘é€packetçš„é€Ÿåº¦ï¼Œä¸ºä½•åè€Œæé€Ÿäº†ï¼Ÿ<br>	æ ‡å‡†TCPæ‹¥å¡ç®—æ³•æ˜¯é‡åˆ°ä¸¢åŒ…çš„æ•°æ®æ—¶å¿«é€Ÿä¸‹é™å‘é€é€Ÿåº¦ï¼Œå› ä¸ºç®—æ³•å‡è®¾ä¸¢åŒ…éƒ½æ˜¯å› ä¸ºè¿‡ç¨‹è®¾å¤‡ç¼“å­˜æ»¡äº†ã€‚å¿«é€Ÿä¸‹é™åé‡æ–°æ…¢å¯åŠ¨ï¼Œæ•´ä¸ªè¿‡ç¨‹å¯¹äºå¸¦å®½æ¥è¯´æ˜¯æµªè´¹çš„ã€‚é€šè¿‡packeté€Ÿåº¦-æ—¶é—´çš„å›¾æ¥çœ‹ï¼Œä»ç§¯åˆ†ä¸Šçœ‹ï¼ŒBBRå……åˆ†åˆ©ç”¨å¸¦å®½æ—¶å‘é€æ•ˆç‡æ‰æ˜¯æœ€é«˜çš„ã€‚å¯ä»¥è¯´BBRæ¯”æ ‡å‡†TCPæ‹¥å¡ç®—æ³•æ›´æ­£ç¡®åœ°å¤„ç†äº†æ•°æ®ä¸¢åŒ…ã€‚å¯¹äºç½‘ç»œä¸Šæœ‰ä¸€å®šä¸¢åŒ…ç‡çš„å…¬ç½‘ï¼ŒBBRä¼šæ›´åŠ æ™ºæ…§ä¸€ç‚¹ã€‚<br>	å›é¡¾ç½‘ç»œå‘å±•è¿‡ç¨‹ï¼Œå¸¦å®½çš„æ˜¯æå¤§åœ°æ”¹è¿›çš„ï¼Œè€Œæœ€å°å»¶è¿Ÿä¼šå—é™ä¸ä»‹è´¨ä¼ æ’­é€Ÿåº¦ï¼Œä¸ä¼šæ˜æ˜¾å‡å°‘ã€‚BBRå¯ä»¥è¯´æ˜¯åº”è¿è€Œç”Ÿã€‚<br><br>3 BBRå¦‚ä½•è§£å†³å»¶æ—¶ï¼Ÿ<br>	S1ï¼šæ…¢å¯åŠ¨å¼€å§‹æ—¶ï¼Œä»¥å‰æœŸçš„å»¶è¿Ÿæ—¶é—´ä¸ºå»¶è¿Ÿæœ€å°å€¼Tminã€‚ç„¶åç›‘æ§å»¶è¿Ÿå€¼æ˜¯å¦è¾¾åˆ°Tminçš„nå€ï¼Œè¾¾åˆ°è¿™ä¸ªé˜€å€¼åï¼Œåˆ¤æ–­å¸¦å®½å·²ç»æ¶ˆè€—å°½ä¸”ä½¿ç”¨äº†ä¸€å®šçš„ç¼“å­˜ï¼Œè¿›å…¥æ’ç©ºé˜¶æ®µã€‚<br>	S2ï¼šæŒ‡æ•°é™ä½å‘é€é€Ÿç‡ï¼Œç›´è‡³å»¶è¿Ÿä¸å†é™ä½ã€‚è¿™ä¸ªè¿‡ç¨‹çš„åŸç†åŒS1<br>	S3ï¼šåè®®è¿›å…¥ç¨³å®šè¿è¡ŒçŠ¶æ€ã€‚äº¤æ›¿æ¢æµ‹å¸¦å®½å’Œå»¶è¿Ÿï¼Œä¸”å¤§å¤šæ•°æ—¶é—´ä¸‹éƒ½å¤„äºå¸¦å®½æ¢æµ‹é˜¶æ®µã€‚<br><br>æ·±å¤œè¯»äº†BBRçš„è®ºæ–‡å’Œç½‘ä¸Šå¤§ç‰›çš„è®²è§£å¾—å‡ºçš„å°ç»“ï¼Œåˆ†äº«ç»™å¤§å®¶ï¼Œè¿‡ç¨‹æ¯”è¾ƒåŒ†å¿™ï¼Œä¸è¶³ä¹‹å¤„ä¹Ÿæœ›è€å¸ˆèƒ½æŒ‡å‡ºæŒ‡æ­£ã€‚ <br></div>
                            <span class="time">2018-06-14 01:47</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¤§å”æ±Ÿå±±</span>
                            </div>
                            <div class="bd">ä½œè€…è¾›è‹¦å•Šï¼Œè¿™ä¸€ç« è¯»èµ·æ¥å¼€å§‹æœ‰ç‚¹ç´¯äº†ğŸ˜‚ <br></div>
                            <span class="time">2018-06-13 08:08</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åæ—</span>
                            </div>
                            <div class="bd">è¿™ä¹ˆè¯´èµ·æ¥ï¼Œæˆ‘ä»¬ç»å¸¸å‘ç°ä¸‹è½½é€Ÿåº¦æ˜¯æ…¢æ…¢çš„å¢åŠ åˆ°é¡¶å³°ï¼Œç„¶åå°±åœ¨é‚£ä¸ªå€¼çš„é™„è¿‘å¾˜å¾Šï¼ŒåŸå› å°±æ˜¯tcpçš„æµé‡æ§åˆ¶å–½ï¼Ÿ <br></div>
                            <span class="time">2018-06-13 08:10</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åœ</span>
                            </div>
                            <div class="bd">å¥½å¥‡ä»€ä¹ˆçº§åˆ«çš„ç¨‹åºå¼€å‘éœ€è¦äº†è§£æ€ä¹ˆç»†ï¼Œå¼€å‘äº†å¥½å¤šç½‘ç»œç¨‹åºéƒ½æ²¡ç”¨åˆ°ï¼Œé‡ä¼ è¿™äº›éƒ½æ˜¯åº”ç”¨å±‚åœ¨åš <br></div>
                            <span class="time">2018-06-24 21:49</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/3b/36/2d61e080.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è¡Œè€…</span>
                            </div>
                            <div class="bd">é—®é¢˜1ï¼Œæƒ³åˆ°BBRå¯ä»¥æ ¹æ®ACKæ—¶é—´æ¥åˆ¤æ–­ï¼Œæ¯”å¦‚åŒä¸€æ—¶åˆ»å‘é€äº†Aã€Bã€Cä¸‰ä¸ªåŒ…ï¼ŒAã€Bä¸¤ä¸ªåŒ…10msæ”¶åˆ°ACKï¼Œè€ŒCåŒ…20msåæ”¶åˆ°ACKï¼Œé‚£ä¹ˆå°±è®¤ä¸ºç½‘ç»œæ‹¥å µæˆ–è¢«ä¸­é—´è®¾å¤‡ç¼“å­˜ï¼Œé™ä½å‘é€é€Ÿåº¦ã€‚<br>é—®é¢˜2ï¼ŒTCPä¼˜ç‚¹åœ¨äºå‡†ç¡®åˆ°è¾¾ï¼Œå¯é æ€§é«˜ï¼Œä½†æ˜¯é€Ÿåº¦æ…¢ï¼›UDPä¼˜ç‚¹åœ¨äºç®€å•ï¼Œä½†æ˜¯ä¸ç¡®è®¤å¯è¾¾ï¼›åƒåç«¯æ¥å£ä¸€èˆ¬ä½¿ç”¨TCPåè®®ï¼Œå› ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼šæœ‰å¤šæ¬¡äº¤äº’ï¼Œä¸”è¯·æ±‚æ•°æ®è¦ç¡®è®¤å¯è¾¾ï¼›ä½†æ˜¯å¦‚æœæ˜¯ç›´æ’­çš„è¯ä½¿ç”¨UDPä¼šæ›´å¥½ï¼Œç®¡ä½ ç½‘ç»œå’‹æ ·ï¼Œåæ­£æˆ‘èµ¶ç´§å‘ï¼Œè®©ç”¨æˆ·ç­‰æ€¥äº†å°±ä¸å¥½äº†ã€‚<br>åˆ˜è€å¸ˆï¼Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¥å£æœ‰æ—¶å€™ä¼šå—åˆ°2æ¬¡ç›¸åŒæ—¶é—´ç›¸åŒå†…å®¹çš„è¯·æ±‚ï¼Œä½†æ˜¯å®¢æˆ·ç«¯ä»…ä»…è°ƒç”¨äº†æ¥å£ä¸€æ¬¡ï¼Œä¼šæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´è¿™ä¸ªé—®é¢˜å‘¢ï¼ŸTCPé‡å¤å‘é€åŒ…å¯¼è‡´çš„å˜›ï¼Ÿ <br></div>
                            <span class="time">2018-06-13 09:17</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/bf/8f/196e555e.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è°›å¬</span>
                            </div>
                            <div class="bd">ä¸å¤ªæ¸…æ¥šç´¯ç§¯åº”ç­”ï¼Œæ¯”å¦‚æ¥æ”¶ç«¯æ”¶åˆ°äº†åŒ…1ã€2ã€3ã€4ï¼Œå®ƒçš„åº”ç­”åº”è¯¥æ˜¯5å—ï¼Ÿä¹Ÿå°±æ˜¯è¯´ä¸­é—´çš„åŒ…å°±ä¸ç”¨åº”ç­”äº†å—ï¼Ÿ <br></div>
                            <span class="time">2018-09-22 20:35</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ˜¯çš„</p>
                                <p class="reply-time">2018-09-22 21:08</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/37/ce/65bf8dc9.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">lyz</span>
                            </div>
                            <div class="bd">jiraå¤ªçœŸå®äº† <br></div>
                            <span class="time">2018-07-24 22:07</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/12/b3/7aef77fd.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">MoFanDon</span>
                            </div>
                            <div class="bd">5çš„ACKä¸¢åŒ…äº†ï¼Œå‡ºå‘å‘é€ç«¯é‡å‘ã€‚é‡å‘è¿‡å»åï¼Œæ¥æ”¶ç«¯å‘ç°æ¥æ”¶è¿‡äº†ï¼Œä¸¢å¼ƒã€‚â€¦â€¦å¦‚æœæ¥æ”¶ç«¯ä¸¢å¼ƒ5åï¼Œæ²¡æœ‰ç»§ç»­å‘é€ACK,é‚£è¿™æ ·ä¸æ˜¯å‘é€ç«¯æ°¸è¿œä¹Ÿä¹Ÿæ²¡æ³•æ¥å—åˆ°5çš„ACKï¼Ÿ <br></div>
                            <span class="time">2018-07-24 08:54</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/8f/ad/6e3e9e15.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">äº§å“åŠ©ç†</span>
                            </div>
                            <div class="bd">é—®é¢˜ï¼š<br><br>1ã€å¦‚ä¸‹å…¬å¼çš„ -1  åˆ°åº•æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ<br><br>	AdvertisedWindow=MaxRcvBuffer-((NextByteExpected-1)-LastByteRead)<br><br>   å›¾ä¾‹ä¸­çš„LastByteReadæ˜¯0è¿˜æ˜¯1ï¼ŸNextByteExpectedæ˜¯6è¿˜æ˜¯5ï¼ŸMaxRcvBufferæ˜¯14å—ï¼Ÿ<br><br>2ã€å¦‚æœæŒ‰ç…§ä¸Šè¿°å…¬å¼ï¼Œé‚£ä¸‹é¢åˆæ˜¯ä¸ºäº†ä»€ä¹ˆï¼Ÿ<br><br>	NextByteExpected åŠ  AdvertisedWindow å°±æ˜¯ç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†çš„åˆ†ç•Œçº¿ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ LastByteRead åŠ ä¸Š MaxRcvBufferã€‚<br><br>	æŒ‰ç…§ç¬¬ä¸€æ¡çš„å…¬å¼ï¼ŒNextByteExpected + AdvertisedWindow = NextByteExpected + ï¼ˆMaxRcvBuffer-((NextByteExpected-1)-LastByteRead))<br>	= MaxRcvBuffer + 1 + LastByteRead<br><br>	åº”è¯¥æœ‰ä¸ª+1å•Šã€‚ã€‚<br><br>å¤šè°¢è€å¸ˆï¼	 <br></div>
                            <span class="time">2018-11-22 15:53</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™é‡Œæˆ‘å†™çš„çš„ç¡®æœ‰é—®é¢˜ï¼Œnextbyteexpectedå…¶å®æ˜¯6ï¼Œå°±æ˜¯ç›®å‰æ¥æ”¶åˆ°äº”ï¼Œä¸‹ä¸€ä¸ªæœŸæœ›çš„æ˜¯å…­ï¼Œè¿™æ ·å°±å¯¹äº†<br>2018-06-13</p>
                                <p class="reply-time">2018-11-22 20:47</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/8b/b3/c340227c.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">GL</span>
                            </div>
                            <div class="bd">ç½‘ç»œå±‚åˆ†ç‰‡å’Œä¼ è¾“å±‚åˆ†ç‰‡æ˜¯æ€ä¹ˆè¿›è¡Œçš„ï¼Ÿ <br></div>
                            <span class="time">2018-06-22 22:56</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ—­é£</span>
                            </div>
                            <div class="bd">åœ¨ä¼ ç»Ÿç®—æ³•å’Œå¿«é€Ÿç®—æ³•çš„å¯¹æ¯”æè¿°ä¸­ï¼Œå¯¹äºå¿«é€Ÿç®—æ³•ä¸­æåˆ° cwndå‡åŠä¸ºcwnd&#47;2ï¼Œsshthresh=cwnd ï¼Œåé¢cwnd=sshthresh+3ï¼Œè½¬æŠ˜ç‚¹æ˜¯20å˜ä¸º13ï¼Œè¿™é‡Œçš„cwndä¸º10å—ï¼Ÿ<br><br>2018-06-15<br><br>î˜ˆÂ ä½œè€…å›å¤<br><br>cwndå…ˆæ˜¯ä¸º10ï¼Œåé¢å˜ä¸º13<br><br>ç»§ä¸Šä¸€ä¸ªé—®é¢˜ï¼Œä¼ ç»Ÿç®—æ³•ï¼Œcwnd ä»1,2,4,8,16æŒ‡æ•°å¢é•¿ï¼Œè¿™æ—¶cwndä¸º16ï¼Œæ”¶å‘æ˜¯ä¸æ˜¯å„å 8ä¸ªï¼Ÿç„¶åç”±16å˜æˆ17ï¼Œæ»¡8ä¸ªç¡®è®¤æ—¶cwndï¼‹1ï¼Œå°±æ˜¯17ï¼Œé‚£ä¹ˆå¢åŠ åˆ°20è¿™é‡Œï¼Œcwndä¸º20ï¼Œè¿™æ—¶äº§ç”Ÿæ‹¥å¡ï¼Œå¦‚æœæ˜¯ä¼ ç»Ÿçš„è¯ï¼Œç«‹é©¬é™ä¸‹æ¥ï¼Œå¦‚æœæ˜¯å¿«é€Ÿï¼Œé‚£ä¹ˆå‡åŠï¼Œä¹Ÿå°±æ˜¯10ï¼Œç­‰å¾…3ä¸ªç¡®è®¤åŒ…ï¼‹3ï¼Œï¼Œåç»­æ¯ä¸€ä¸ªç¡®è®¤cwndå°±ï¼‹1å—ï¼Ÿè¿˜æ˜¯ï¼Ÿè¿™æ ·å­ç†è§£å—ï¼Ÿ <br></div>
                            <span class="time">2018-06-19 09:35</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ˜¯çš„</p>
                                <p class="reply-time">2018-06-19 15:57</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/63/f4/6fdc1508.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">é™ˆæ ‹</span>
                            </div>
                            <div class="bd">ç¬¬ä¸‰éƒ¨åˆ†å’Œç¬¬å››éƒ¨åˆ†åˆ†ç•Œçº¿å†™é”™äº†ï¼Œåº”è¯¥æ˜¯lastByteSent+advertisedWindow <br></div>
                            <span class="time">2018-06-19 09:30</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ²¡é”™çš„ï¼Œadvertisewindowæ˜¯é‚£ä¸ªé»‘æ¡†ï¼Œä¸æ˜¯æ¥ä¸‹æ¥èƒ½å‘çš„éƒ¨åˆ†</p>
                                <p class="reply-time">2018-06-19 11:30</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ—­é£</span>
                            </div>
                            <div class="bd">åœ¨ä¼ ç»Ÿç®—æ³•å’Œå¿«é€Ÿç®—æ³•çš„å¯¹æ¯”æè¿°ä¸­ï¼Œå¯¹äºå¿«é€Ÿç®—æ³•ä¸­æåˆ° cwndå‡åŠä¸ºcwnd&#47;2ï¼Œsshthresh=cwnd ï¼Œåé¢cwnd=sshthresh+3ï¼Œè½¬æŠ˜ç‚¹æ˜¯20å˜ä¸º13ï¼Œè¿™é‡Œçš„cwndä¸º10å—ï¼Ÿ <br></div>
                            <span class="time">2018-06-15 15:06</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">cwndå…ˆæ˜¯ä¸º10ï¼Œåé¢å˜ä¸º13</p>
                                <p class="reply-time">2018-06-15 18:36</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/e9/91/da888d22.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åˆå­¦è€…</span>
                            </div>
                            <div class="bd">fack åº”è¯¥ä¸æ˜¯æ”¶åˆ°ä¸€ä¸ªå¤§äºæœŸæœ›çš„åŒ…å‘é€ä¸‰ä¸ªackï¼Œæ”¶åˆ°ä¸€ä¸ªåŒ…åªä¼šå›å¤è¿™ä¸ªackå§ <br></div>
                            <span class="time">2018-06-14 01:01</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/d1/15/7d47de48.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å’–å•¡çŒ«å£é‡Œçš„å’–å•¡çŒ«ğŸ±</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼ŒTCPåè®®æ ˆï¼Œä¿è¯åŒ…ä¸€å®šåˆ°å—ï¼Œï¼Œå“ªå‡ ç§æƒ…å†µä¸‹ä¼šä¸¢å¤±ï¼Œï¼Œï¼Œèƒ½ä¸èƒ½æ€»ç»“ä¸‹ <br></div>
                            <span class="time">2018-06-13 12:15</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä¸èƒ½ä¿è¯ï¼Œåªæ˜¯å°½åŠ›é‡è¯•ï¼Œå†é‡è¯•</p>
                                <p class="reply-time">2018-06-14 18:46</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/fe/c5/3467cf94.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ­£æ˜¯é‚£æœµç«ç‘°</span>
                            </div>
                            <div class="bd">ä¸ºå¤§ç‰›ç‚¹èµï¼Œæœ‰ç‚¹å¤æ‚ï¼Œå…ˆæ…¢æ…¢æ¶ˆåŒ–ä¸‹ï¼›å…ˆé—®ä¸ªé—®é¢˜ï¼Œtcpå»ºç«‹è¿æ¥åï¼Œæ¯å‘é€ä¸€ä¸ªæ•°æ®åŒ…éƒ½è¦åƒä¸‰æ¬¡æ¡æ‰‹ä¸€æ ·æ¥å›ä¸‰æ¬¡ä¹ˆï¼Œå‘é€æ•°æ®-å‘é€ack-å›å¤ackï¼Œæ‰ç®—æ•°æ®å‘é€æˆåŠŸï¼Ÿ <br></div>
                            <span class="time">2018-06-13 08:33</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/37/1b/8a75023d.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ‹¿ç¬”å°æ˜Ÿ</span>
                            </div>
                            <div class="bd">æ€ä¹ˆåŠï¼Œè¶Šåˆ°åé¢è¶Šçœ‹ä¸æ‡‚äº†ï¼Œæ²¡æœ‰ç½‘ç»œåŸºç¡€ï¼Œè€æ¹¿æœ‰ä»€ä¹ˆå»ºè®®å—ï¼Ÿ <br></div>
                            <span class="time">2018-12-08 20:58</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/51/33/56f8bcbe.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">yinhua_upc</span>
                            </div>
                            <div class="bd"><br>&quot;6ã€7 æ˜¯ç­‰å¾…æ¥æ”¶çš„ï¼›8ã€9 æ˜¯å·²ç»æ¥æ”¶ï¼Œä½†æ˜¯æ²¡æœ‰ ACK çš„&quot;<br>ä»æ¥æ”¶ç«¯çš„å›¾çœ‹6-14éƒ½æ˜¯ç­‰å¾…æ¥æ”¶æœªç¡®è®¤ï¼Œä¸ºä»€ä¹ˆ8ã€9æ˜¯å·²ç»æ¥æ”¶ï¼Ÿ<br> <br></div>
                            <span class="time">2018-11-09 10:34</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å‡è®¾ï¼Œæ‰€ä»¥ç”»äº†å®çº¿</p>
                                <p class="reply-time">2018-11-10 09:10</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/6f/63/8808cc00.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ‰¬ï½</span>
                            </div>
                            <div class="bd">2ä¸ªé—®é¢˜ï¼š<br>1. TCPå¯é çš„è¿æ¥ä¼šä¸ä¼šå½±å“åˆ°ä¸šåŠ¡å±‚ï¼Œæ¯”å¦‚è¶…æ—¶é‡ä¼ å¯¼è‡´äº†æœåŠ¡ç«¯å‡½æ•°è°ƒç”¨2æ¬¡ï¼Œé‚£å²‚ä¸æ˜¯ä¸šåŠ¡éƒ½è¦è€ƒè™‘å¹‚ç­‰æ€§äº†ï¼Œæˆ‘å¾ˆæ‡µé€¼ï¼Œæœç„¶æ˜¯æ‡‚å¾—è¶Šå¤šè¶Šç™½ç—´ã€‚<br>2. æ‹¥å¡æ§åˆ¶çš„çª—å£è·Ÿæµé‡æ§åˆ¶çš„çª—å£ä¸€å›äº‹å—ï¼Œè¿˜æ˜¯æµé‡æ§åˆ¶çš„çª—å£çš„å‡ºæ¥åå°±ä¼šè¿›å…¥æ‹¥å¡æ§åˆ¶çª—å£ï¼Ÿ <br></div>
                            <span class="time">2018-11-01 17:48</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä¸ä¼šï¼Œé‡ä¼ çš„åŒ…ä¸ä¼šäº¤ç»™åº”ç”¨å±‚ã€‚æ˜¯ä¸€ä¸ªçª—å£</p>
                                <p class="reply-time">2018-11-02 10:17</p>
                            </div>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>